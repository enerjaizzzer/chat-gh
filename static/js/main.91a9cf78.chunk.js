(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{55:function(e,t,a){e.exports=a(85)},83:function(e,t,a){},85:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"settingUser",function(){return P}),a.d(n,"messages",function(){return _});var r=a(0),s=a.n(r),o=a(10),c=a.n(o),l=a(8),u=a(12),i=a(13),m=a(16),g=a(14),f=a(17),p=a(88),d=a(89),h=a(54),b=a(90),E=a(32),v=a(93),O=a(91),N=a(92),y=a(25),w=a(28),k=a.n(w),j=a(29);function U(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?U(a,!0).forEach(function(t){Object(j.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):U(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var C={settingUser:{loginUser:!1,numberUser:0,defaultAvatar:"https://windows10free.ru/uploads/posts/2017-04/1493287748_1487679899_icon-user-640x640.png",users:[]}},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOG_IN":var a=!1,n=0;return e.users.forEach(function(e,r){e.nickName===t.payload.nickName&&e.password===t.payload.password&&(a=!0,n=r)}),a||alert("wrong login or password"),S({},e,{loginUser:a,numberUser:n});case"USER_REGISTRATION":var r=!1,s=0,o={};e.users.forEach(function(a){a.nickName===t.payload.nickName?alert("Nickname is busy"):(r=e.users.length,s=e.users.length,o={nickName:t.payload.nickName,password:t.payload.password,avatar:t.payload.avatar})});var c=S({},e);return c.loginUser=r,c.numberUser=s,c.users.push(o),c;case"USER_LOG_OUT":return S({},e,{loginUser:t.payload});default:return e}};function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(a,!0).forEach(function(t){Object(j.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var I={message:{userIsHere:!0,countMessages:0,formValue:"",someoneMessages:[],yourMessages:[]}},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SOMEONE_MESSAGE":var a=e;return e.someoneMessages.length>=10&&a.someoneMessages.shift(),e.userIsHere||(a.countMessages+=1),a.someoneMessages.push(t.payload),a.someoneMessages.sort(function(e,t){return e.time-t.time}),x({},a);case"YOUR_MESSAGE":var n=e;return e.yourMessages.length>=10&&n.yourMessages.shift(),n.yourMessages.unshift(t.payload),x({},n);case"SAVE_FORM_VALUE":var r=t.payload.formValue.length;return x({},e,{formValue:"".concat(e.formValue).concat(t.payload.formValue[r-1])});case"USER_IS_HERE":return x({},e,{userIsHere:t.payload.user,countMessages:t.payload.count});default:return e}},R={settingUser:{loginUser:!1,numberUser:0,defaultAvatar:"https://windows10free.ru/uploads/posts/2017-04/1493287748_1487679899_icon-user-640x640.png",users:[{nickName:"Guest(id=".concat(k()(),")"),password:"admin",avatar:"https://hostenko.com/wpcafe/wp-content/uploads/wpavatar.png"}]},messages:{userIsHere:!0,countMessages:0,formValue:"",someoneMessages:[],yourMessages:[]}},A=Object(y.b)(n),V=Object(y.c)(A,R),D=function(e,t){return{type:"USER_LOG_IN",payload:{nickName:e,password:t}}},G=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).onChangeNickName=function(e){a.valueNickName=e.target.value},a.onChangePassword=function(e){a.valuePassword=e.target.value},a.submitValue=function(e){e.preventDefault(),V.dispatch(D(a.valueNickName,a.valuePassword))},a}return Object(f.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.valueNickName=" ",this.valuePassword=" ",s.a.createElement(O.a,Object.assign({},this.props,{size:"xs","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),s.a.createElement(N.a,{className:"text-center modal-form bg-dark text-light",onSubmit:this.submitValue},s.a.createElement(N.a.Group,{controlId:"formBasicEmail"},s.a.createElement(N.a.Label,{className:"title-form"},"Send your Nickname"),s.a.createElement(N.a.Control,{type:"text",onChange:this.onChangeNickName,placeholder:"NickName"}),s.a.createElement(N.a.Label,{className:"title-form"},"Send Password"),s.a.createElement(N.a.Control,{type:"password",onChange:this.onChangePassword,placeholder:"Password"})),s.a.createElement(v.a,{variant:"outline-light",type:"submit",className:"button"},"LogIn")))}}]),t}(r.Component),H=function(){var e=s.a.useState(!1),t=Object(E.a)(e,2),a=t[0],n=t[1];return s.a.createElement(s.a.Fragment,null,s.a.createElement(v.a,{className:"button",variant:"outline-light",onClick:function(){return n(!0)}},"LogIn"),s.a.createElement(G,{show:a,onHide:function(){return n(!1)}}))},L=function(e,t){return{type:"USER_REGISTRATION",payload:{nickName:e,password:t,avatar:"https://hostenko.com/wpcafe/wp-content/uploads/wpavatar.png"}}},F=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(g.a)(t).call(this,e))).submitValue=function(e){e.preventDefault(),V.dispatch(L(a.valueNickName,a.valuePassword))},a.onChangeNickName=function(e){a.valueNickName=e.target.value},a.onChangePassword=function(e){a.valuePassword=e.target.value},a.valueNickName="",a.valuePassword="",a}return Object(f.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement(O.a,Object.assign({},this.props,{size:"xs","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),s.a.createElement(N.a,{className:"text-center modal-form bg-dark text-light",onSubmit:this.submitValue},s.a.createElement(N.a.Group,{controlId:"formBasicEmail"},s.a.createElement(N.a.Label,{className:"title-form"},"Invent your Nickname"),s.a.createElement(N.a.Control,{type:"text",onChange:this.onChangeNickName,placeholder:"NickName"}),s.a.createElement(N.a.Label,{className:"title-form"},"Invent your Password"),s.a.createElement(N.a.Control,{type:"password",onChange:this.onChangePassword,placeholder:"Password"})),s.a.createElement(v.a,{variant:"outline-light",type:"submit",className:"button"},"Registration")))}}]),t}(r.Component),T=function(){var e=s.a.useState(!1),t=Object(E.a)(e,2),a=t[0],n=t[1];return s.a.createElement(s.a.Fragment,null,s.a.createElement(v.a,{className:"button",variant:"outline-light",onClick:function(){return n(!0)}},"Registration"),s.a.createElement(F,{show:a,onHide:function(){return n(!1)}}))},B=a(87),z=Object(l.b)(function(e){return{userInformation:e.settingUser.users[e.settingUser.numberUser]}})(function(e){var t=e.userInformation;return console.log(t),s.a.createElement(s.a.Fragment,null,s.a.createElement(b.a.Brand,{href:"#home",className:"text-light logo"},t.nickName),s.a.createElement(B.a,{src:t.avatar,className:"avatar",roundedCircle:!0}))}),J=function(){return{type:"USER_LOG_OUT",payload:!1}},W=function(){return s.a.createElement(v.a,{className:"button",variant:"outline-light",onClick:function(){return V.dispatch(J())}},"LogOut")},Y=Object(l.b)(function(e){return{loginUser:e.settingUser.loginUser}})(function(e){var t=e.loginUser;return s.a.createElement(p.a,{className:"fixed-top bg-dark header",fluid:!0},s.a.createElement(d.a,null,s.a.createElement(h.a,{xs:2},s.a.createElement(b.a.Brand,{href:"#home",className:"text-light logo"},"Chat.[enerjaizzzer]")),!t&&s.a.createElement(h.a,{xs:{span:2,offset:8}},s.a.createElement(H,null),s.a.createElement(T,null)),t&&s.a.createElement(s.a.Fragment,null,s.a.createElement(h.a,{xs:{span:2,offset:7}},s.a.createElement(z,null)),s.a.createElement(h.a,{xs:1},s.a.createElement(W,null)))))}),$=Object(l.b)(function(e){return{messages:e.messages,avatar:e.settingUser.users[e.settingUser.numberUser].avatar,defaultAvatar:e.settingUser.defaultAvatar,nickName:e.settingUser.users[e.settingUser.numberUser].nickName}})(function(e){var t=e.messages,a=e.avatar,n=e.nickName,r=e.defaultAvatar,o=document.scrollingElement||document.body;o.scrollTop=o.scrollHeight+50;var c=t.someoneMessages.map(function(e){return s.a.createElement(d.a,{key:k()(),className:"message-block"},s.a.createElement(h.a,{xs:1},s.a.createElement(B.a,{src:(t=e.nickName,o=n,t===o?a:r),className:"message-avatar",roundedCircle:!0})),s.a.createElement(h.a,{xs:11},s.a.createElement("h2",{className:"message-nickName"},e.nickName),s.a.createElement("p",{className:"message-text"},e.message),s.a.createElement("p",{className:"message-date"},function(e){var t=new Date(e);return"".concat(t.getDate(),"-").concat(t.getMonth()+1,"-").concat(t.getFullYear()," ").concat(t.getHours(),":").concat(t.getMinutes())}(e.time))));var t,o});return s.a.createElement(s.a.Fragment,null,c)}),q=Object(l.b)(function(e){return{nickName:e.settingUser.users[e.settingUser.numberUser].nickName}})(function(e){var t=e.nickName,a=document.scrollingElement||document.body;return a.scrollTop=a.scrollHeight+50,s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,t," ","connected!"))}),K=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement(p.a,{className:"main",fluid:!0},s.a.createElement(d.a,null,s.a.createElement(h.a,null,s.a.createElement($,null),s.a.createElement(q,null))))}}]),t}(r.Component),Q=function(e,t){return{type:"YOUR_MESSAGE",payload:{nickName:e,message:t}}},X=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).onChangeMessage=function(e){a.message=e.target.value},a.submitValue=function(e){e.preventDefault(),a.nickName=a.userInformation.nickName,V.dispatch(Q(a.nickName,a.message)),a.ws.send(JSON.stringify({from:a.nickName,message:a.message})),e.target.form.value=""},a}return Object(f.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.userInformation,a=e.ws;return this.userInformation=t,this.ws=a,s.a.createElement(p.a,{className:"fixed-bottom bg-dark footer",fluid:!0},s.a.createElement(N.a,{className:"text-center",onSubmit:this.submitValue},s.a.createElement(d.a,null,s.a.createElement(h.a,{xs:11},s.a.createElement(N.a.Control,{id:"form",type:"text",onChange:this.onChangeMessage,placeholder:"Text message",className:"send-form"})),s.a.createElement(h.a,{xs:1},s.a.createElement(v.a,{variant:"outline-light",type:"submit",className:"button"},"Submit")))))}}]),t}(r.Component),Z=Object(l.b)(function(e){return{userInformation:e.settingUser.users[e.settingUser.numberUser]}})(X),ee=function(e,t,a){return{type:"SOMEONE_MESSAGE",payload:{nickName:e,message:t,time:a}}},te=function(e){var t=e;t.onopen=function(){},t.onmessage=function(e){JSON.parse(e.data).forEach(function(e){V.dispatch(ee(e.from,e.message,e.time))})}},ae=function(e,t){return{type:"USER_IS_HERE",payload:{user:e,count:t}}},ne=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(m.a)(this,Object(g.a)(t).call(this))).ws=new WebSocket("ws://st-chat.shas.tel"),e}return Object(f.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.count,a=e.user;return te(this.ws),window.onfocus=function(){document.title="Chat",V.dispatch(ae(!0,0))},window.onblur=function(){V.dispatch(ae(!1,t))},a||(document.title="".concat(t," unread messages")),s.a.createElement(s.a.Fragment,null,s.a.createElement(Y,null),s.a.createElement(K,null),s.a.createElement(Z,{ws:this.ws}))}}]),t}(r.Component),re=Object(l.b)(function(e){return{count:e.messages.countMessages,user:e.messages.userIsHere}})(ne);a(83),a(84),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(s.a.createElement(l.a,{store:V},s.a.createElement(re,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[55,1,2]]]);
//# sourceMappingURL=main.91a9cf78.chunk.js.map