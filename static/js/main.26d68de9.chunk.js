(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{56:function(e,t,a){e.exports=a(86)},84:function(e,t,a){},86:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"settingUser",function(){return I}),a.d(n,"messages",function(){return A});var r=a(0),s=a.n(r),o=a(15),c=a.n(o),l=a(5),i=a(9),u=a(10),m=a(12),g=a(11),p=a(13),d=a(52),f=a(89),b=a(90),h=a(55),N=a(92),v=a(25),E=a(95),y=a(93),O=a(94),w=a(26),k=a(29),U=a(30),j=a.n(U);function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(a,!0).forEach(function(t){Object(k.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var x={settingUser:{loginUser:!1,numberUser:0,defaultAvatar:"https://windows10free.ru/uploads/posts/2017-04/1493287748_1487679899_icon-user-640x640.png",users:[]}},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOG_IN":var a=!1,n=0;return e.users.forEach(function(e,r){e.nickName===t.payload.nickName&&e.password===t.payload.password&&(a=!0,n=r)}),a||alert("wrong login or password"),C({},e,{loginUser:a,numberUser:n});case"USER_REGISTRATION":var r=!1,s=0,o={};e.users.forEach(function(a){a.nickName===t.payload.nickName?alert("Nickname is busy"):(r=!0,s=e.users.length,o={nickName:t.payload.nickName,password:t.payload.password,avatar:t.payload.avatar})});var c=C({},e);return c.id="".concat(j()()),c.loginUser=r,c.numberUser=s,c.users.push(o),c;case"USER_LOG_OUT":return C({},e,{loginUser:t.payload.logunUser,numberUser:t.payload.numberUser});case"USER_CHANGE_NICK_NAME":var l=e;return l.users[l.numberUser].nickName=t.payload,l;case"LOAD":return C({},e,{loginUser:t.payload.loginUser,numberUser:t.payload.numberUser,users:t.payload.users});default:return e}};function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(a,!0).forEach(function(t){Object(k.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var _={message:{userIsHere:!0,countMessages:0,formValue:"",someoneMessages:[],yourMessages:[]}},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SOMEONE_MESSAGE":var a=e;return e.someoneMessages.length>=100&&a.someoneMessages.shift(),e.userIsHere||(a.countMessages+=1),a.someoneMessages.push(t.payload),a.someoneMessages.sort(function(e,t){return e.time-t.time}),a.spinner=!1,M({},a);case"YOUR_MESSAGE":var n=e;return e.yourMessages.length>=100&&n.yourMessages.shift(),n.yourMessages.unshift(t.payload),M({},n);case"SAVE_FORM_VALUE":var r=t.payload.formValue.length;return M({},e,{formValue:"".concat(e.formValue).concat(t.payload.formValue[r-1])});case"USER_IS_HERE":return M({},e,{userIsHere:t.payload.user,countMessages:t.payload.count});default:return e}},R=Object(w.b)(n),D=Object(w.c)(R,{settingUser:{loginUser:!1,numberUser:0,defaultAvatar:"https://windows10free.ru/uploads/posts/2017-04/1493287748_1487679899_icon-user-640x640.png",users:[{id:"",nickName:"Guest",password:"admin",avatar:"https://hostenko.com/wpcafe/wp-content/uploads/wpavatar.png"}]},messages:{spinner:!0,userIsHere:!0,countMessages:0,formValue:"",someoneMessages:[],yourMessages:[]}}),L=function(e,t){return{type:"USER_LOG_IN",payload:{nickName:e,password:t}}},G=function(e,t,a){return{type:"SOMEONE_MESSAGE",payload:{nickName:e,message:t,time:a}}},V=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).onChangeNickName=function(e){a.valueNickName=e.target.value},a.onChangePassword=function(e){a.valuePassword=e.target.value},a.submitValue=function(e){e.preventDefault();var t=Date.now();D.dispatch(L(a.valueNickName,a.valuePassword)),D.dispatch(G(a.valueNickName,"LogIn",t))},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.valueNickName=" ",this.valuePassword=" ",s.a.createElement(y.a,Object.assign({},this.props,{size:"xs","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),s.a.createElement(O.a,{className:"text-center modal-form bg-dark text-light",onSubmit:this.submitValue},s.a.createElement(O.a.Group,null,s.a.createElement(O.a.Label,{className:"title-form"},"Send your Nickname"),s.a.createElement(O.a.Control,{id:"formName",type:"text",onChange:this.onChangeNickName,placeholder:"NickName"}),s.a.createElement(O.a.Label,{className:"title-form"},"Send Password"),s.a.createElement(O.a.Control,{id:"formPassword",type:"password",onChange:this.onChangePassword,placeholder:"Password"})),s.a.createElement(E.a,{variant:"outline-light",type:"submit",className:"button"},"LogIn")))}}]),t}(r.Component),H=function(){var e=s.a.useState(!1),t=Object(v.a)(e,2),a=t[0],n=t[1];return s.a.createElement(s.a.Fragment,null,s.a.createElement(E.a,{className:"button",variant:"outline-light",onClick:function(){return n(!0)}},"LogIn"),s.a.createElement(V,{show:a,onHide:function(){return n(!1)}}))},F=function(e,t){return{type:"USER_REGISTRATION",payload:{nickName:e,password:t,avatar:"https://hostenko.com/wpcafe/wp-content/uploads/wpavatar.png"}}},T=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(g.a)(t).call(this,e))).submitValue=function(e){e.preventDefault();var t=Date.now();D.dispatch(F(a.valueNickName,a.valuePassword)),D.dispatch(G(a.valueNickName,"registration",t))},a.onChangeNickName=function(e){a.valueNickName=e.target.value},a.onChangePassword=function(e){a.valuePassword=e.target.value},a.valueNickName="",a.valuePassword="",a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return s.a.createElement(y.a,Object.assign({},this.props,{size:"xs","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),s.a.createElement(O.a,{className:"text-center modal-form bg-dark text-light",onSubmit:this.submitValue},s.a.createElement(O.a.Group,null,s.a.createElement(O.a.Label,{className:"title-form"},"Invent your Nickname"),s.a.createElement(O.a.Control,{id:"formName",type:"text",onChange:this.onChangeNickName,placeholder:"NickName"}),s.a.createElement(O.a.Label,{className:"title-form"},"Invent your Password"),s.a.createElement(O.a.Control,{id:"formPassword",type:"password",onChange:this.onChangePassword,placeholder:"Password"})),s.a.createElement(E.a,{variant:"outline-light",type:"submit",className:"button"},"Registration")))}}]),t}(r.Component),z=function(){var e=s.a.useState(!1),t=Object(v.a)(e,2),a=t[0],n=t[1];return s.a.createElement(s.a.Fragment,null,s.a.createElement(E.a,{className:"button",variant:"outline-light",onClick:function(){return n(!0)}},"Registration"),s.a.createElement(T,{show:a,onHide:function(){return n(!1)}}))},J=a(88),B=function(e){return{type:"USER_CHANGE_NICK_NAME",payload:e}},W=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(g.a)(t).call(this,e))).submitValue=function(e){e.preventDefault();var t=Date.now();D.dispatch(B(a.valueNickName,a.valuePassword)),D.dispatch(G(a.valueNickName,"changed nickname",t))},a.onChangeNickName=function(e){a.valueNickName=e.target.value},a.valueNickName="",a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return s.a.createElement(y.a,Object.assign({},this.props,{size:"xs","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),s.a.createElement(O.a,{className:"text-center modal-form bg-dark text-light",onSubmit:this.submitValue},s.a.createElement(O.a.Group,{controlId:"formChangeName"},s.a.createElement(O.a.Label,{className:"title-form"},"Invent your new Nickname"),s.a.createElement(O.a.Control,{type:"text",onChange:this.onChangeNickName,placeholder:"NickName"})),s.a.createElement(E.a,{variant:"outline-light",type:"submit",className:"button"},"Change")))}}]),t}(r.Component),Y=Object(l.b)(function(e){return{userInformation:e.settingUser.users[e.settingUser.numberUser]}})(function(e){var t=e.userInformation,a=s.a.useState(!1),n=Object(v.a)(a,2),r=n[0],o=n[1];return s.a.createElement(s.a.Fragment,null,s.a.createElement(N.a.Brand,{href:"#home",className:"text-light logo",onClick:function(){return o(!0)}},t.nickName),s.a.createElement(W,{show:r,onHide:function(){return o(!1)}}),s.a.createElement(J.a,{src:t.avatar,className:"avatar",roundedCircle:!0}))}),K=function(){return{type:"USER_LOG_OUT",payload:{loginUser:!1,numberUser:0}}},$=Object(l.b)(function(e){return{userInformation:e.settingUser.users[e.settingUser.numberUser]}})(function(e){var t=e.userInformation;return s.a.createElement(E.a,{className:"button",variant:"outline-light",onClick:function(){var e=Date.now();D.dispatch(G(t.nickName,"LogOut",e)),D.dispatch(K())}},"LogOut")}),q=Object(l.b)(function(e){return{loginUser:e.settingUser.loginUser}})(function(e){var t=e.loginUser;return s.a.createElement(f.a,{className:"fixed-top bg-dark header",fluid:!0},s.a.createElement(b.a,null,s.a.createElement(h.a,{xs:2},s.a.createElement(N.a.Brand,{href:"#home",className:"text-light logo"},"Chat.[enerjaizzzer]")),!t&&s.a.createElement(h.a,{xs:10,className:"header-buttons"},s.a.createElement(H,null),s.a.createElement(z,null)),t&&s.a.createElement(s.a.Fragment,null,s.a.createElement(h.a,{xs:{span:2,offset:7}},s.a.createElement(Y,null)),s.a.createElement(h.a,{xs:1},s.a.createElement($,null)))))}),Q=a(91),X=Object(l.b)(function(e){return{messages:e.messages,avatar:e.settingUser.users[e.settingUser.numberUser].avatar,defaultAvatar:e.settingUser.defaultAvatar,nickName:e.settingUser.users[e.settingUser.numberUser].nickName}})(function(e){var t=e.messages,a=e.avatar,n=e.nickName,r=e.defaultAvatar,o=document.scrollingElement||document.body;o.scrollTop=o.scrollHeight+50;var c=function(e,t){return e===t?a:r},l=t.someoneMessages.map(function(e){return s.a.createElement(b.a,{key:j()(),className:(t=e.nickName,a=n,t===a?"message-row my":"message-row")},s.a.createElement(h.a,{xl:1,xs:2,className:"block-message-avatar"},s.a.createElement(J.a,{src:c(e.nickName,n),className:"message-avatar",roundedCircle:!0})),s.a.createElement(h.a,{xl:11,xs:10,className:"block-message"},s.a.createElement("h2",{className:"message-nickName"},e.nickName),s.a.createElement("p",{className:"message-text"},e.message),s.a.createElement("p",{className:"message-date"},function(e){var t=new Date(e);return"".concat(t.getDate(),"-").concat(t.getMonth()+1,"-").concat(t.getFullYear()," ").concat(t.getHours(),":").concat(t.getMinutes())}(e.time))));var t,a});return s.a.createElement(s.a.Fragment,null,l)}),Z=Object(l.b)(function(e){return{nickName:e.settingUser.users[e.settingUser.numberUser].nickName}})(function(e){var t=e.nickName,a=document.scrollingElement||document.body;return a.scrollTop=a.scrollHeight+50,s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,t," ","connected!"))}),ee=function(e){function t(){return Object(i.a)(this,t),Object(m.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.spinner;return s.a.createElement(f.a,{className:"main",fluid:!0},s.a.createElement(b.a,{className:"justify-content-md-center"},e&&s.a.createElement(h.a,{className:"spinner-block"},s.a.createElement(Q.a,{animation:"border",role:"status",className:"spinner",variant:"dark"},s.a.createElement("span",{className:"sr-only"},"Loading..."))),!e&&s.a.createElement(h.a,null,s.a.createElement(s.a.Fragment,null,s.a.createElement(X,null),s.a.createElement(Z,null)))))}}]),t}(r.Component),te=Object(l.b)(function(e){return{spinner:e.messages.spinner}})(ee),ae=function(e,t){return{type:"YOUR_MESSAGE",payload:{nickName:e,message:t}}},ne=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).onChangeMessage=function(e){a.message=e.target.value},a.submitValue=function(e){e.preventDefault(),a.nickName=a.userInformation.nickName,D.dispatch(ae(a.nickName,a.message)),a.ws.send(JSON.stringify({from:a.nickName,message:a.message})),e.target.form.value=""},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.userInformation,a=e.ws;return this.userInformation=t,this.ws=a,s.a.createElement(f.a,{className:"fixed-bottom bg-dark footer",fluid:!0},s.a.createElement(O.a,{className:"text-center",onSubmit:this.submitValue},s.a.createElement(b.a,null,s.a.createElement(h.a,{xl:11,md:10,xs:9},s.a.createElement(O.a.Control,{id:"form",type:"text",onChange:this.onChangeMessage,placeholder:"Text message",className:"send-form"})),s.a.createElement(h.a,{xl:1,md:2,xs:3},s.a.createElement(E.a,{variant:"outline-light",type:"submit",className:"button"},"Submit")))))}}]),t}(r.Component),re=Object(l.b)(function(e){return{userInformation:e.settingUser.users[e.settingUser.numberUser]}})(ne),se=function(e){var t=e;t.onopen=function(){},t.onmessage=function(e){JSON.parse(e.data).slice(0,99).forEach(function(e){D.dispatch(G(e.from,e.message,e.time))})}},oe=function(e){var t=JSON.stringify(e);localStorage.setItem("settingUser",t)},ce=function(e,t,a){return{type:"LOAD",payload:{loginUser:e,numberUser:t,users:a}}},le=function(){var e=JSON.parse(localStorage.getItem("settingUser"));D.dispatch(ce(e.loginUser,e.numberUser,e.users))},ie=function(e,t){return{type:"USER_IS_HERE",payload:{user:e,count:t}}},ue=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(m.a)(this,Object(g.a)(t).call(this))).ws=new WebSocket("wss://wssproxy.herokuapp.com/"),e.ws=new d.a("wss://wssproxy.herokuapp.com/"),e}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.count,a=e.user,n=e.settingUser;return se(this.ws),window.onload=function(){return le()},window.onunload=function(){return oe(n)},window.onfocus=function(){document.title="Chat",D.dispatch(ie(!0,0))},window.onblur=function(){D.dispatch(ie(!1,t))},a||(document.title="".concat(t," unread messages")),s.a.createElement(s.a.Fragment,null,s.a.createElement(q,null),s.a.createElement(te,null),s.a.createElement(re,{ws:this.ws}))}}]),t}(r.Component),me=Object(l.b)(function(e){return{count:e.messages.countMessages,user:e.messages.userIsHere,settingUser:e.settingUser}})(ue);a(84),a(85),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(s.a.createElement(l.a,{store:D},s.a.createElement(me,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[56,1,2]]]);
//# sourceMappingURL=main.26d68de9.chunk.js.map