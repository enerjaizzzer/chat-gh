(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{56:function(e,a,t){e.exports=t(86)},84:function(e,a,t){},86:function(e,a,t){"use strict";t.r(a);var n={};t.r(n),t.d(n,"settingUser",function(){return P}),t.d(n,"messages",function(){return R});var r=t(0),s=t.n(r),o=t(15),c=t.n(o),l=t(5),i=t(9),u=t(10),m=t(13),g=t(11),p=t(12),d=t(52),f=t(89),h=t(90),b=t(55),N=t(93),v=t(25),E=t(95),y=t(92),O=t(94),w=t(26),k=t(29),j=t(30),U=t.n(j);function C(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function S(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?C(t,!0).forEach(function(a){Object(k.a)(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(t).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}var x={settingUser:{loginUser:!1,numberUser:0,defaultAvatar:"https://windows10free.ru/uploads/posts/2017-04/1493287748_1487679899_icon-user-640x640.png",users:[]}},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"USER_LOG_IN":var t=!1,n=0;return e.users.forEach(function(e,r){e.nickName===a.payload.nickName&&e.password===a.payload.password&&(t=!0,n=r)}),t||alert("wrong login or password"),S({},e,{loginUser:t,numberUser:n});case"USER_REGISTRATION":var r=!1,s=0,o={};e.users.forEach(function(t){t.nickName===a.payload.nickName?alert("Nickname is busy"):(r=!0,s=e.users.length,o={nickName:a.payload.nickName,password:a.payload.password,avatar:a.payload.avatar})});var c=S({},e);return c.id="".concat(U()()),c.loginUser=r,c.numberUser=s,c.users.push(o),c;case"USER_LOG_OUT":return S({},e,{loginUser:a.payload.logunUser,numberUser:a.payload.numberUser});case"USER_CHANGE_NICK_NAME":var l=e;return l.users[l.numberUser].nickName=a.payload,l;default:return e}};function I(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function M(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?I(t,!0).forEach(function(a){Object(k.a)(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):I(t).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}var _={message:{userIsHere:!0,countMessages:0,formValue:"",someoneMessages:[],yourMessages:[]}},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"SOMEONE_MESSAGE":var t=e;return e.someoneMessages.length>=100&&t.someoneMessages.shift(),e.userIsHere||(t.countMessages+=1),t.someoneMessages.push(a.payload),t.someoneMessages.sort(function(e,a){return e.time-a.time}),t.spinner=!1,M({},t);case"YOUR_MESSAGE":var n=e;return e.yourMessages.length>=100&&n.yourMessages.shift(),n.yourMessages.unshift(a.payload),M({},n);case"SAVE_FORM_VALUE":var r=a.payload.formValue.length;return M({},e,{formValue:"".concat(e.formValue).concat(a.payload.formValue[r-1])});case"USER_IS_HERE":return M({},e,{userIsHere:a.payload.user,countMessages:a.payload.count});default:return e}},A=Object(w.b)(n),D=Object(w.c)(A,{settingUser:{loginUser:!1,numberUser:0,defaultAvatar:"https://windows10free.ru/uploads/posts/2017-04/1493287748_1487679899_icon-user-640x640.png",users:[{id:"",nickName:"Guest",password:"admin",avatar:"https://hostenko.com/wpcafe/wp-content/uploads/wpavatar.png"}]},messages:{spinner:!0,userIsHere:!0,countMessages:0,formValue:"",someoneMessages:[],yourMessages:[]}}),G=function(e,a){return{type:"USER_LOG_IN",payload:{nickName:e,password:a}}},L=function(e,a,t){return{type:"SOMEONE_MESSAGE",payload:{nickName:e,message:a,time:t}}},V=function(e){function a(){var e,t;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=Object(m.a)(this,(e=Object(g.a)(a)).call.apply(e,[this].concat(r)))).onChangeNickName=function(e){t.valueNickName=e.target.value},t.onChangePassword=function(e){t.valuePassword=e.target.value},t.submitValue=function(e){e.preventDefault();var a=Date.now();D.dispatch(G(t.valueNickName,t.valuePassword)),D.dispatch(L(t.valueNickName,"LogIn",a))},t}return Object(p.a)(a,e),Object(u.a)(a,[{key:"render",value:function(){return this.valueNickName=" ",this.valuePassword=" ",s.a.createElement(y.a,Object.assign({},this.props,{size:"xs","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),s.a.createElement(O.a,{className:"text-center modal-form bg-dark text-light",onSubmit:this.submitValue},s.a.createElement(O.a.Group,null,s.a.createElement(O.a.Label,{className:"title-form"},"Send your Nickname"),s.a.createElement(O.a.Control,{id:"formName",type:"text",onChange:this.onChangeNickName,placeholder:"NickName"}),s.a.createElement(O.a.Label,{className:"title-form"},"Send Password"),s.a.createElement(O.a.Control,{id:"formPassword",type:"password",onChange:this.onChangePassword,placeholder:"Password"})),s.a.createElement(E.a,{variant:"outline-light",type:"submit",className:"button"},"LogIn")))}}]),a}(r.Component),H=function(){var e=s.a.useState(!1),a=Object(v.a)(e,2),t=a[0],n=a[1];return s.a.createElement(s.a.Fragment,null,s.a.createElement(E.a,{className:"button",variant:"outline-light",onClick:function(){return n(!0)}},"LogIn"),s.a.createElement(V,{show:t,onHide:function(){return n(!1)}}))},F=function(e,a){return{type:"USER_REGISTRATION",payload:{nickName:e,password:a,avatar:"https://hostenko.com/wpcafe/wp-content/uploads/wpavatar.png"}}},T=function(e){function a(e){var t;return Object(i.a)(this,a),(t=Object(m.a)(this,Object(g.a)(a).call(this,e))).submitValue=function(e){e.preventDefault();var a=Date.now();D.dispatch(F(t.valueNickName,t.valuePassword)),D.dispatch(L(t.valueNickName,"registration",a))},t.onChangeNickName=function(e){t.valueNickName=e.target.value},t.onChangePassword=function(e){t.valuePassword=e.target.value},t.valueNickName="",t.valuePassword="",t}return Object(p.a)(a,e),Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement(y.a,Object.assign({},this.props,{size:"xs","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),s.a.createElement(O.a,{className:"text-center modal-form bg-dark text-light",onSubmit:this.submitValue},s.a.createElement(O.a.Group,null,s.a.createElement(O.a.Label,{className:"title-form"},"Invent your Nickname"),s.a.createElement(O.a.Control,{id:"formName",type:"text",onChange:this.onChangeNickName,placeholder:"NickName"}),s.a.createElement(O.a.Label,{className:"title-form"},"Invent your Password"),s.a.createElement(O.a.Control,{id:"formPassword",type:"password",onChange:this.onChangePassword,placeholder:"Password"})),s.a.createElement(E.a,{variant:"outline-light",type:"submit",className:"button"},"Registration")))}}]),a}(r.Component),z=function(){var e=s.a.useState(!1),a=Object(v.a)(e,2),t=a[0],n=a[1];return s.a.createElement(s.a.Fragment,null,s.a.createElement(E.a,{className:"button",variant:"outline-light",onClick:function(){return n(!0)}},"Registration"),s.a.createElement(T,{show:t,onHide:function(){return n(!1)}}))},B=t(88),J=function(e){return{type:"USER_CHANGE_NICK_NAME",payload:e}},W=function(e){function a(e){var t;return Object(i.a)(this,a),(t=Object(m.a)(this,Object(g.a)(a).call(this,e))).submitValue=function(e){e.preventDefault();var a=Date.now();D.dispatch(J(t.valueNickName,t.valuePassword)),D.dispatch(L(t.valueNickName,"changed nickname",a))},t.onChangeNickName=function(e){t.valueNickName=e.target.value},t.valueNickName="",t}return Object(p.a)(a,e),Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement(y.a,Object.assign({},this.props,{size:"xs","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),s.a.createElement(O.a,{className:"text-center modal-form bg-dark text-light",onSubmit:this.submitValue},s.a.createElement(O.a.Group,{controlId:"formChangeName"},s.a.createElement(O.a.Label,{className:"title-form"},"Invent your new Nickname"),s.a.createElement(O.a.Control,{type:"text",onChange:this.onChangeNickName,placeholder:"NickName"})),s.a.createElement(E.a,{variant:"outline-light",type:"submit",className:"button"},"Change")))}}]),a}(r.Component),Y=Object(l.b)(function(e){return{userInformation:e.settingUser.users[e.settingUser.numberUser]}})(function(e){var a=e.userInformation,t=s.a.useState(!1),n=Object(v.a)(t,2),r=n[0],o=n[1];return s.a.createElement(s.a.Fragment,null,s.a.createElement(N.a.Brand,{href:"#home",className:"text-light logo",onClick:function(){return o(!0)}},a.nickName),s.a.createElement(W,{show:r,onHide:function(){return o(!1)}}),s.a.createElement(B.a,{src:a.avatar,className:"avatar",roundedCircle:!0}))}),K=function(){return{type:"USER_LOG_OUT",payload:{loginUser:!1,numberUser:0}}},$=Object(l.b)(function(e){return{userInformation:e.settingUser.users[e.settingUser.numberUser]}})(function(e){var a=e.userInformation;return s.a.createElement(E.a,{className:"button",variant:"outline-light",onClick:function(){var e=Date.now();D.dispatch(L(a.nickName,"LogOut",e)),D.dispatch(K())}},"LogOut")}),q=Object(l.b)(function(e){return{loginUser:e.settingUser.loginUser}})(function(e){var a=e.loginUser;return s.a.createElement(f.a,{className:"fixed-top bg-dark header",fluid:!0},s.a.createElement(h.a,null,s.a.createElement(b.a,{xs:2},s.a.createElement(N.a.Brand,{href:"#home",className:"text-light logo"},"Chat.[enerjaizzzer]")),!a&&s.a.createElement(b.a,{xs:10,className:"header-buttons"},s.a.createElement(H,null),s.a.createElement(z,null)),a&&s.a.createElement(s.a.Fragment,null,s.a.createElement(b.a,{xs:{span:2,offset:7}},s.a.createElement(Y,null)),s.a.createElement(b.a,{xs:1},s.a.createElement($,null)))))}),Q=t(91),X=Object(l.b)(function(e){return{messages:e.messages,avatar:e.settingUser.users[e.settingUser.numberUser].avatar,defaultAvatar:e.settingUser.defaultAvatar,nickName:e.settingUser.users[e.settingUser.numberUser].nickName}})(function(e){var a=e.messages,t=e.avatar,n=e.nickName,r=e.defaultAvatar,o=document.scrollingElement||document.body;o.scrollTop=o.scrollHeight+50;var c=function(e,a){return e===a?t:r},l=a.someoneMessages.map(function(e){return s.a.createElement(h.a,{key:U()(),className:(a=e.nickName,t=n,a===t?"message-row my":"message-row")},s.a.createElement(b.a,{xl:1,xs:2,className:"block-message-avatar"},s.a.createElement(B.a,{src:c(e.nickName,n),className:"message-avatar",roundedCircle:!0})),s.a.createElement(b.a,{xl:11,xs:10,className:"block-message"},s.a.createElement("h2",{className:"message-nickName"},e.nickName),s.a.createElement("p",{className:"message-text"},e.message),s.a.createElement("p",{className:"message-date"},function(e){var a=new Date(e);return"".concat(a.getDate(),"-").concat(a.getMonth()+1,"-").concat(a.getFullYear()," ").concat(a.getHours(),":").concat(a.getMinutes())}(e.time))));var a,t});return s.a.createElement(s.a.Fragment,null,l)}),Z=Object(l.b)(function(e){return{nickName:e.settingUser.users[e.settingUser.numberUser].nickName}})(function(e){var a=e.nickName,t=document.scrollingElement||document.body;return t.scrollTop=t.scrollHeight+50,s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,a," ","connected!"))}),ee=function(e){function a(){return Object(i.a)(this,a),Object(m.a)(this,Object(g.a)(a).apply(this,arguments))}return Object(p.a)(a,e),Object(u.a)(a,[{key:"render",value:function(){var e=this.props.spinner;return s.a.createElement(f.a,{className:"main",fluid:!0},s.a.createElement(h.a,{className:"justify-content-md-center"},e&&s.a.createElement(b.a,{className:"spinner-block"},s.a.createElement(Q.a,{animation:"border",role:"status",className:"spinner",variant:"dark"},s.a.createElement("span",{className:"sr-only"},"Loading..."))),!e&&s.a.createElement(b.a,null,s.a.createElement(s.a.Fragment,null,s.a.createElement(X,null),s.a.createElement(Z,null)))))}}]),a}(r.Component),ae=Object(l.b)(function(e){return{spinner:e.messages.spinner}})(ee),te=function(e,a){return{type:"YOUR_MESSAGE",payload:{nickName:e,message:a}}},ne=function(e){function a(){var e,t;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=Object(m.a)(this,(e=Object(g.a)(a)).call.apply(e,[this].concat(r)))).onChangeMessage=function(e){t.message=e.target.value},t.submitValue=function(e){e.preventDefault(),t.nickName=t.userInformation.nickName,D.dispatch(te(t.nickName,t.message)),t.ws.send(JSON.stringify({from:t.nickName,message:t.message})),e.target.form.value=""},t}return Object(p.a)(a,e),Object(u.a)(a,[{key:"render",value:function(){var e=this.props,a=e.userInformation,t=e.ws;return this.userInformation=a,this.ws=t,s.a.createElement(f.a,{className:"fixed-bottom bg-dark footer",fluid:!0},s.a.createElement(O.a,{className:"text-center",onSubmit:this.submitValue},s.a.createElement(h.a,null,s.a.createElement(b.a,{xl:11,md:10,xs:9},s.a.createElement(O.a.Control,{id:"form",type:"text",onChange:this.onChangeMessage,placeholder:"Text message",className:"send-form"})),s.a.createElement(b.a,{xl:1,md:2,xs:3},s.a.createElement(E.a,{variant:"outline-light",type:"submit",className:"button"},"Submit")))))}}]),a}(r.Component),re=Object(l.b)(function(e){return{userInformation:e.settingUser.users[e.settingUser.numberUser]}})(ne),se=function(e){var a=e;a.onopen=function(){},a.onmessage=function(e){var a=JSON.parse(e.data).slice(0,99);console.log(a),a.forEach(function(e){D.dispatch(L(e.from,e.message,e.time))})}},oe=function(e,a){return{type:"USER_IS_HERE",payload:{user:e,count:a}}},ce=function(e){function a(){var e;return Object(i.a)(this,a),(e=Object(m.a)(this,Object(g.a)(a).call(this))).ws=new WebSocket("wss://wssproxy.herokuapp.com/"),e.ws=new d.a("wss://wssproxy.herokuapp.com/"),e}return Object(p.a)(a,e),Object(u.a)(a,[{key:"render",value:function(){var e=this.props,a=e.count,t=e.user;return se(this.ws),window.onfocus=function(){document.title="Chat",D.dispatch(oe(!0,0))},window.onblur=function(){D.dispatch(oe(!1,a))},t||(document.title="".concat(a," unread messages")),s.a.createElement(s.a.Fragment,null,s.a.createElement(q,null),s.a.createElement(ae,null),s.a.createElement(re,{ws:this.ws}))}}]),a}(r.Component),le=Object(l.b)(function(e){return{count:e.messages.countMessages,user:e.messages.userIsHere}})(ce);t(84),t(85),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(s.a.createElement(l.a,{store:D},s.a.createElement(le,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[56,1,2]]]);
//# sourceMappingURL=main.3e3e733d.chunk.js.map